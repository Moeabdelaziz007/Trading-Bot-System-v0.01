name = "trading-brain-v1"
main = "src/worker.py"
account_id = "ac5004cd1897da0d9ae75df53afb3a70" 
compatibility_date = "2024-04-05"
compatibility_flags = ["python_workers"]

# üåê Deploy to workers.dev (no custom domain needed)
workers_dev = true

# ‚è∞ THE HEARTBEAT: Cron Triggers (Free Tier: 5 crons max)
# Optimized for Mini-Agent Swarm + Core Agents
[triggers]
crons = [
    "* * * * *",    # üõ°Ô∏è RiskGuardian + SwarmHeartbeat (1m)
    "*/5 * * * *",  # ‚ö° MomentumScout + VolatilitySpiker (5m)
    "*/15 * * * *", # üì∞ ReversionHunter + LiquidityWatcher (15m)
    "0 * * * *",    # üß† Strategist + PerformanceMonitor (1h)
    "0 0 * * *"     # üèÜ ContestManager - Daily Ranking (midnight UTC)
]

# üß† MEMORY: KV Namespace
[[kv_namespaces]]
binding = "BRAIN_MEMORY"
id = "e31a120e1f8f40dbb17d3278d2921c6e"

# üíæ DATABASE: D1 (SQLite at Edge)
[[d1_databases]]
binding = "TRADING_DB"
database_name = "trading-brain-db"
database_id = "9d4168e4-391c-4b79-a20a-6661e599fde6"

# üßä COLD STORAGE: R2 Bucket
[[r2_buckets]]
binding = "MARKET_ARCHIVE"
bucket_name = "market-archive"

# ü§ñ AI: Workers AI (FREE LLMs - 10K neurons/day)
[ai]
binding = "AI"

# üîë Environment Variables (Non-sensitive only)
[vars]
CAPITAL_DEMO = "true"
# üéØ Mini-Agent Swarm Configuration (NEW v2.1)
TRADING_MODE = "SIMULATION"  # SIMULATION | PAPER | LIVE
# üìä ROI Targets (Adjusted based on mathematical analysis)
# 730% requires 7.27% daily for 30 days - EXTREMELY HIGH RISK
# Realistic targets: 10-20% monthly (top-decile performance)
TARGET_MONTHLY_ROI = "0.20"   # 20% Realistic Target (was 7.30)
AGGRESSIVE_ROI_TARGET = "7.30" # 730% (Bybit leverage required)
MAX_DRAWDOWN_LIMIT = "0.05"  # 5% Max Drawdown (Circuit Breaker)
LEVERAGE_MODE = "DYNAMIC"    # DYNAMIC | FIXED
DEFAULT_LEVERAGE = "1.0"     # Start with 1x (safety)
ASSET_ROUTING = "AUTO"       # AUTO | ALPACA_ONLY | BYBIT_ONLY
# Strategy Mode: HFT is mathematically impossible on Alpaca (fees + latency)
# Pivot to EVENT_DRIVEN for pattern detection (FVG, Liquidity Voids)
STRATEGY_MODE = "EVENT_DRIVEN"  # HFT | SWING | EVENT_DRIVEN

# ==========================================
# üîê SECRETS MANAGEMENT
# ==========================================
# Secrets are encrypted and set via `wrangler secret put <NAME>`
# They are NOT stored in this file for security!
#
# Required Secrets:
# wrangler secret put ABLY_API_KEY
# wrangler secret put GROQ_API_KEY
# wrangler secret put DEEPSEEK_API_KEY
# wrangler secret put ALPACA_KEY
# wrangler secret put ALPACA_SECRET
# wrangler secret put CAPITAL_API_KEY
# wrangler secret put CAPITAL_EMAIL
# wrangler secret put CAPITAL_PASSWORD
# wrangler secret put BYBIT_API_KEY      # ‚úÖ Configured
# wrangler secret put BYBIT_API_SECRET   # ‚úÖ Configured
#
# For local development, create a `.dev.vars` file with these keys.
# The `.dev.vars` file is automatically ignored by git.


# ==========================================
# üè∞ THE CITADEL (Architecture v2.0)
# ==========================================

# üîí STATE: Durable Objects (DISABLED - Requires paid plan or specific Python class structure)
# [[durable_objects.bindings]]
# name = "TRADE_MANAGER"
# class_name = "TradeManager"

# üì® EXECUTION: Queues (Async Reliability) - DISABLED (Requires Paid Plan)
# [[queues.producers]]
# queue = "trade-queue"
# binding = "TRADE_QUEUE"

# [[queues.consumers]]
# queue = "trade-queue"
# max_batch_size = 5
# max_batch_timeout = 5

# üì¶ MIGRATIONS (DISABLED)
# [[migrations]]
# tag = "v1"
# new_sqlite_classes = ["TradeManager"]
