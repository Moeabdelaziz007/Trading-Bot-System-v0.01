name = "trading-brain-v1"
main = "src/worker.py"
account_id = "ac5004cd1897da0d9ae75df53afb3a70" 
compatibility_date = "2024-04-05"
compatibility_flags = ["python_workers"]

# ğŸŒ Deploy to workers.dev (no custom domain needed)
workers_dev = true

# â° THE HEARTBEAT: Single Cron (Free Tier Limit)
# Internal dispatch logic in worker.py handles 5min/4hr cycles
[triggers]
crons = [
    "* * * * *",    # ğŸ›¡ï¸ RiskGuardian (1m)
    "*/5 * * * *",  # âš¡ Scalper (5m)
    "*/15 * * * *", # ğŸ“° Journalist (15m)
    "0 * * * *"     # ğŸ§  Strategist (1h)
]

# ğŸ§  MEMORY: KV Namespace
[[kv_namespaces]]
binding = "BRAIN_MEMORY"
id = "e31a120e1f8f40dbb17d3278d2921c6e"

# ğŸ’¾ DATABASE: D1 (SQLite at Edge)
[[d1_databases]]
binding = "TRADING_DB"
database_name = "trading-brain-db"
database_id = "9d4168e4-391c-4b79-a20a-6661e599fde6"

# ğŸ§Š COLD STORAGE: R2 Bucket
[[r2_buckets]]
binding = "MARKET_ARCHIVE"
bucket_name = "market-archive"

# ğŸ¤– AI: Workers AI (FREE LLMs - 10K neurons/day)
[ai]
binding = "AI"

# ğŸ”‘ Environment Variables (Non-sensitive only)
[vars]
CAPITAL_DEMO = "true"

# ==========================================
# ğŸ” SECRETS MANAGEMENT
# ==========================================
# Secrets are encrypted and set via `wrangler secret put <NAME>`
# They are NOT stored in this file for security!
#
# Required Secrets:
# wrangler secret put ABLY_API_KEY
# wrangler secret put GROQ_API_KEY
# wrangler secret put DEEPSEEK_API_KEY
# wrangler secret put ALPACA_KEY
# wrangler secret put ALPACA_SECRET
# wrangler secret put CAPITAL_API_KEY
# wrangler secret put CAPITAL_EMAIL
# wrangler secret put CAPITAL_PASSWORD
#
# For local development, create a `.dev.vars` file with these keys.
# The `.dev.vars` file is automatically ignored by git.


# ==========================================
# ğŸ° THE CITADEL (Architecture v2.0)
# ==========================================

# ğŸ”’ STATE: Durable Objects (DISABLED - Requires paid plan or specific Python class structure)
# [[durable_objects.bindings]]
# name = "TRADE_MANAGER"
# class_name = "TradeManager"

# ğŸ“¨ EXECUTION: Queues (Async Reliability) - DISABLED (Requires Paid Plan)
# [[queues.producers]]
# queue = "trade-queue"
# binding = "TRADE_QUEUE"

# [[queues.consumers]]
# queue = "trade-queue"
# max_batch_size = 5
# max_batch_timeout = 5

# ğŸ“¦ MIGRATIONS (DISABLED)
# [[migrations]]
# tag = "v1"
# new_sqlite_classes = ["TradeManager"]
