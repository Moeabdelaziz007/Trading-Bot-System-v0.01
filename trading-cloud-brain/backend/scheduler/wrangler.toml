name = "axiom-scheduler"
main = "index.py"
compatibility_date = "2024-04-05"
compatibility_flags = ["python_workers"]

# ğŸ”’ NO public access - internal only
workers_dev = false

# â° CRON TRIGGERS
[triggers]
crons = [
    "* * * * *",      # ğŸ›¡ï¸ RiskGuardian + Dynamic Check (1m)
    # Scalper/Journalist logic handled dynamically inside code
]

# ğŸ”— Service Bindings
[[services]]
binding = "TRADING_BRAIN"
service = "axiom-trading-brain"
environment = "production"

[[services]]
binding = "DREAM_ENGINE"
service = "axiom-dream-engine"
environment = "production"

# ğŸ’¾ R2 for Data Lake
[[r2_buckets]]
binding = "MARKET_ARCHIVE"
bucket_name = "market-archive"

# ğŸ§  KV for State
[[kv_namespaces]]
binding = "BRAIN_MEMORY"
id = "e31a120e1f8f40dbb17d3278d2921c6e"

# ğŸ’¾ D1 Database
[[d1_databases]]
binding = "TRADING_DB"
database_name = "trading-brain-db"
database_id = "9d4168e4-391c-4b79-a20a-6661e599fde6"

# ğŸ“¨ QUEUES (Event-Driven Architecture)
[[queues.consumers]]
queue = "trade-queue"
max_batch_size = 5
max_batch_timeout = 5

[[queues.consumers]]
queue = "broadcast-queue"
max_batch_size = 10
max_batch_timeout = 5

[[queues.producers]]
queue = "trade-queue"
binding = "TRADE_QUEUE"

[[queues.producers]]
queue = "broadcast-queue"
binding = "BROADCAST_QUEUE"
